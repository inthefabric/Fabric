using Fabric.New.Domain;

namespace Fabric.New.Operations.Oauth.Grant {

	/*================================================================================================*/
	public interface IOauthGrantTasks {


		////////////////////////////////////////////////////////////////////////////////////////////////
		/*--------------------------------------------------------------------------------------------*/
		long AppIdToLong(string pAppId);

		/*--------------------------------------------------------------------------------------------*/
		void VerifyAppDomain(App pApp, string pRedirectUri);


		////////////////////////////////////////////////////////////////////////////////////////////////
		/*--------------------------------------------------------------------------------------------*/
		App GetApp(IOperationData pData, long pAppId);

		/*--------------------------------------------------------------------------------------------*/
		User GetUserByMember(IOperationData pData, Member pMember);

		/*--------------------------------------------------------------------------------------------*/
		User GetUserByCredentials(IOperationData pData, string pUsername, string pPassword);

		/*--------------------------------------------------------------------------------------------*/
		Member GetOrAddMember(IOperationContext pOpCtx, long pAppId, long pUserId);


		////////////////////////////////////////////////////////////////////////////////////////////////
		/*--------------------------------------------------------------------------------------------*/
		void DenyScope(IOperationData pData, Member pMember);

		/*--------------------------------------------------------------------------------------------*/
		void UpdateGrant(IOperationContext pOpCtx, Member pMember, string pRedirectUri);


		////////////////////////////////////////////////////////////////////////////////////////////////
		/*--------------------------------------------------------------------------------------------*/
		OauthException NewFault(GrantErrors pErr, GrantErrorDescs pDesc);

	}

}